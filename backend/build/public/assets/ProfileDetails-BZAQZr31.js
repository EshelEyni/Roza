import{e as j,c as x,i as N,k as q,j as e,l as V,m as L,u as H,a as T,b as D,n as U,d as B}from"./index-BKuXz_yj.js";import{H as P,B as c,c as w,E as y,M,P as R}from"./PageContent-D57lKvj_.js";import{P as A,a as Q,H as z}from"./P-j1db5U2u.js";import{u as b,F as C,I as u,R as p}from"./ReactHookFormInput-NCgr8ydc.js";const K=()=>{const{loggedInUser:a}=j(),{t:r}=x();if(!a)return null;const n=N(a.createdAt,a.language),o=q(a.language),s=[{key:r("username"),value:a.username},{key:r("fullName"),value:a.fullname},{key:r("email"),value:a.email},{key:r("language"),value:o},{key:r("signup"),value:n}];return e.jsx("section",{className:"mt-5 flex flex-col gap-2 rounded-lg bg-app-200 p-6 text-app-800",children:s.map(l=>e.jsxs(A,{children:[e.jsxs("strong",{children:[l.key,":"]})," ",l.value]},l.key))})},W=()=>{const{loggedInUser:a}=j(),{updateUser:r,isPendindUpdateUser:n,isErrorUpdateUser:o,errorUpdateUser:s}=V(),l=L(),{t}=x(),{register:d,handleSubmit:f,formState:{errors:m},setValue:g,watch:E,trigger:h}=b({defaultValues:{username:(a==null?void 0:a.username)||"",fullname:(a==null?void 0:a.fullname)||"",email:(a==null?void 0:a.email)||"",language:(a==null?void 0:a.language)||"en"}}),v=async i=>{if(!a)return;const F={...a,...i};r(F)};function k(i){g("language",i)}const S=E("language");return a?e.jsxs(C,{onSubmit:f(v),children:[e.jsx(P,{children:t("profileEditTitle")}),e.jsx(u,{label:t("username"),fieldError:m.username,htmlFor:"username",children:e.jsx(p,{register:d,name:"username",required:t("formValidation.mandatory.username"),placeholder:t("username"),trigger:h})}),e.jsx(u,{label:t("fullName"),fieldError:m.fullname,htmlFor:"fullname",children:e.jsx(p,{register:d,name:"fullname",required:t("formValidation.mandatory.fullname"),placeholder:t("fullname"),trigger:h})}),e.jsx(u,{label:t("email"),fieldError:m.email,htmlFor:"email",children:e.jsx(p,{register:d,name:"email",type:"email",required:t("formValidation.mandatory.email"),placeholder:t("email"),trigger:h})}),e.jsx(u,{label:t("language"),fieldError:m.language,children:e.jsx("div",{className:"flex gap-2 space-x-2",children:l.map(i=>e.jsx(c,{type:"button",className:w("rounded-md bg-app-500 px-4 py-1 text-white hover:bg-app-600",{"!bg-app-600":S===i.value}),onClick:()=>k(i.value),children:i.name},i.value))})}),o&&e.jsx(y,{msg:s==null?void 0:s.message}),e.jsx(Q,{}),e.jsx(c,{type:"submit",disabled:n,addedClassName:"self-center !px-4 !py-1",children:t("btnSubmit")})]}):null};function $(){const a=H(),{mutate:r,isPending:n,isError:o,error:s}=T({mutationFn:async({currentPassword:l,newPassword:t,newPasswordConfirm:d})=>D.updatePassword({currentPassword:l,newPassword:t,newPasswordConfirm:d}),onSuccess:()=>{a.invalidateQueries({queryKey:["loggedInUser"]})}});return{updatePassword:r,isPendingUpdatePassword:n,isErrorUpdatePassword:o,errorUpdatePassword:s}}const G=()=>{const{updatePassword:a,isPendingUpdatePassword:r,isErrorUpdatePassword:n,errorUpdatePassword:o}=$(),{t:s}=x(),{register:l,handleSubmit:t,formState:{errors:d},trigger:f}=b(),m=async g=>{a(g)};return e.jsxs(C,{onSubmit:t(m),children:[e.jsx(P,{children:s("passwordEditTitle")}),e.jsx(u,{label:s("currentPassword"),fieldError:d.currentPassword,htmlFor:"currentPassword",children:e.jsx(p,{register:l,name:"currentPassword",type:"password",required:s("formValidation.mandatory.currentPassword"),placeholder:s("currentPassword"),trigger:f})}),e.jsx(u,{label:s("newPassword"),fieldError:d.newPassword,htmlFor:"newPassword",children:e.jsx(p,{register:l,name:"newPassword",type:"password",required:s("formValidation.mandatory.newPassword"),placeholder:s("newPassword"),trigger:f})}),e.jsx(u,{label:s("newPasswordConfirm"),fieldError:d.newPasswordConfirm,htmlFor:"newPasswordConfirm",children:e.jsx(p,{register:l,name:"newPasswordConfirm",type:"password",required:s("formValidation.mandatory.newPasswordConfirm"),placeholder:s("newPasswordConfirm"),trigger:f})}),n&&e.jsx(y,{msg:o==null?void 0:o.message}),e.jsx(c,{type:"submit",disabled:r,addedClassName:"self-center !px-4 !py-1",children:s("btnSubmit")})]})},J=({tab:a,setTab:r})=>{const{t:n}=x();return e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-4",children:[a!=="display"&&e.jsx(c,{addedClassName:"rounded-md bg-app-500 !px-4 !py-1 text-white hover:bg-app-600",onClick:()=>r("display"),children:n("btnCancel")}),e.jsx(c,{addedClassName:w("rounded-md bg-app-500 !px-4 !py-1 text-white hover:bg-app-600",{"bg-app-600":a==="edit"}),onClick:()=>r("edit"),children:n("btnEdit")}),e.jsx(c,{addedClassName:w("rounded-md bg-app-500 !px-4 !py-1 text-white hover:bg-app-600",{"bg-app-600":a==="password"}),onClick:()=>r("password"),children:n("btnPassword")})]})},_=()=>{const{tab:a,setTab:r}=U(),{loggedInUser:n}=j();return B(`Roza / Profile - ${(n==null?void 0:n.fullname)||""}`),n?e.jsx(M,{children:e.jsxs(R,{children:[e.jsx(z,{children:n.fullname}),a==="display"&&e.jsx(K,{}),a==="edit"&&e.jsx(W,{}),a==="password"&&e.jsx(G,{}),e.jsx(J,{tab:a,setTab:r})]})}):null};export{_ as default};
